
<!doctype html>

<html>
<head>
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
  <meta name="theme-color" content="#4F7DC9">
  <meta charset="UTF-8">
  <title>Voiceflowハンズオン＆ワークショップ：インタラクティブな物語スキルを作ろう</title>
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Code+Pro:400|Roboto:400,300,400italic,500,700|Roboto+Mono">
  <link rel="stylesheet" href="//fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="https://storage.googleapis.com/codelab-elements/codelab-elements.css">
  <style>
    .success {
      color: #1e8e3e;
    }
    .error {
      color: red;
    }
  </style>
</head>
<body>
  <google-codelab-analytics gaid="UA-49880327-14"></google-codelab-analytics>
  <google-codelab codelab-gaid=""
                  id="dist"
                  title="Voiceflowハンズオン＆ワークショップ：インタラクティブな物語スキルを作ろう"
                  environment="web"
                  feedback-link="https://github.com/kun432/voiceflow-handson-story/issues">
    
      <google-codelab-step label="概要" duration="0">
        <h2 is-upgraded>はじめに</h2>
<p class="image-container"><img alt="story01-001" src="img/7211548bbca918e7.png"></p>
<p>本資料は、「Voiceflowハンズオン＆ワークショップ：インタラクティブな物語スキルを作ろう」のハンズオン用資料になります。</p>
<p>アカウントのセットアップなど事前準備は以下をご覧ください。</p>
<ul>
<li>Voiceflowハンズオン: アカウントのセットアップ手順<br><a href="https://vf-handson-setup.netlify.com/#0" target="_blank">https://vf-handson-setup.netlify.com/#0</a></li>
</ul>
<h2 is-upgraded>注意</h2>
<aside class="warning"><p>本手順書は2019年11月21日時点のものですが、Voiceflowの開発はかなり活発なので、本手順書通りに進めてもうまくいかない場合や画面が変更されている場合があります。ご容赦ください。（必要な場合は補足します）</p>
</aside>
<aside class="special"><p>不具合やお気づきの点があれば、<a href="https://github.com/kun432/voiceflow-handson-story/issues" target="_blank">https://github.com/kun432/voiceflow-handson-story/issues</a>でissue立てていただければと思います。PRも歓迎！</p>
</aside>
<aside class="special"><p>不具合やお気づきの点があれば、kun432.8d1w@gmail.comまで。</p>
</aside>
<h2 is-upgraded>更新履歴</h2>
<ul>
<li>2019/11/21    公開</li>
</ul>
<p>ではNextをクリックしてください</p>


      </google-codelab-step>
    
      <google-codelab-step label="本日作っていただくスキル" duration="0">
        <p>本日皆さんに作っていただくスキルは「シンデレラ」のお話です。</p>
<p class="image-container"><img alt="cinderella" src="img/72d12672b1f8f499.png"></p>
<p>皆さんもよくご存知のこのストーリーを以下のような工夫をすることで、楽しくインタラクティブなAlexaスキルにします。</p>
<ul>
<li>サウンドや効果音をたくさん使ってにぎやかな感じにします。</li>
<li>登場人物のキャラクターごとに声を使い分けます。</li>
<li>単にお話を聞くだけではなくて、ユーザの発話を元にストーリーが進んだり分岐したりします。</li>
</ul>
<p>スキルの全体はこういう感じになっています。</p>
<p class="image-container"><img alt="story01-001" src="img/b73d6dec744e69cd.png"></p>
<ul>
<li>物語部分は全4シーンで構成されています。時間の関係上、本来の「シンデレラ」よりも短くしています。</li>
<li>可能な限り、スムーズに進むようにコピペ用テキストを用意してます。</li>
<li>ポイントとなるところは詳しく説明します。</li>
<li>ご自宅に帰ってから実際に動かしてみたり、中身を確認できるように完成したものをダウンロードできるようにしておきます。</li>
</ul>
<h2 is-upgraded>注意</h2>
<aside class="warning"><p>このスキルを審査・公開しないようにお願いします。今後のワークショップで使えなくなってしまいます。</p>
</aside>
<p>では、がんばっていきましょう！</p>
<p>Nextをクリックしてください。</p>


      </google-codelab-step>
    
      <google-codelab-step label="プロジェクトの作成" duration="0">
        <h2 is-upgraded>プロジェクトの作成</h2>
<p>最初にプロジェクトを作成して、かんたんにVoiceflowの画面の説明を行います。</p>
<p>以下のURLにアクセスしてください。<br><a href="https://voiceflow.com/" target="_blank">https://voiceflow.com/</a></p>
<p>右上の&#34;Log in&#34;をクリック。</p>
<p class="image-container"><img alt="story02-001" src="img/7bbaedc0450694be.png"></p>
<p>アカウント作成した際のメールアドレスとパスワードを入力して&#34;Sign in&#34;をクリックします。</p>
<p class="image-container"><img alt="story02-002" src="img/4e2e849d8e23d747.png"></p>
<p>プロジェクトの一覧画面が表示されます。Default Listと書いてあるところの一番下の&#34;Create Project&#34;をクリックします。</p>
<p class="image-container"><img alt="story02-003" src="img/57bbd4ca99e2cafa.png"></p>
<p>プロジェクト作成画面が開きますので、以下の通り設定して、最後に&#34;Create Project&#34;をクリックします。</p>
<ul>
<li>プロジェクト名<ul>
<li>今回は「世界のおとえほん」と入力してください。</li>
<li>スキルを呼び出すときのデフォルトの名前になります。（例：「アレクサ、◯◯◯を開いて」）</li>
<li>後でプロジェクト名と呼び出し名のそれぞれを変更することも可能です。</li>
</ul>
</li>
<li>言語: &#34;English(US)&#34;のチェックを外して、&#34;Japanese(JP)&#34;にチェック</li>
</ul>
<p class="image-container"><img alt="story02-004" src="img/5ffdc5ed7dba4a17.png"></p>
<p>プロジェクトが作成されると&#34;Canvas&#34;画面が表示されます。&#34;Canvas&#34;画面がVoiceflowでスキルを作成する基本画面になります。</p>
<ul>
<li>最初から用意してあるHome Blockの中にあるStartがスタート地点になります。</li>
<li>左のBlocksメニューにいろんな機能のBlockが用意されています。ここからBlockを選択してCANVAS上に配置します。</li>
<li>CANVASに配置したBlockの設定を行い、アレクサに発話させたり、ユーザの発話を受け取ったりします。</li>
<li>Block同士を線でつなげることで、会話の流れがつながっていきます。</li>
<li>アップロードボタンをクリックすると、作成したプロジェクトがAlexa開発者コンソールにアップロードされ、Amazon Echoなどで呼び出せるようになります。</li>
<li>Blocksメニュー以外にもいくつか別のメニューがありますが、後で説明します。</li>
</ul>
<p class="image-container"><img alt="story02-005" src="img/3dd575c47266eb21.png"></p>
<p>では早速やってみましょう。</p>


      </google-codelab-step>
    
      <google-codelab-step label="シーン０: 基本操作" duration="0">
        <h2 is-upgraded>CANVASとBlock</h2>
<p>Voiceflowでは、いろんな機能を持ったBlockをCanvasに配置して線をつなぐことで、会話の流れを作ることになります。試しに少しやってみましょう。</p>
<p>左のBlocksメニューの一番上にある&#34;Speak&#34;というブロックを、最初から配置してあるHome Blockの右側あたりにドラッグ＆ドロップで配置してください。すると、画面の右側に別の設定画面が出てくると思います。</p>
<p class="image-container"><img alt="story02-006" src="img/4c537c010a645c14.png"></p>
<p>この設定画面の右上の入力欄に以下と入力してみてください。</p>
<pre><code>世界のおとえほんにようこそ。このスキルでは、世界の有名な童話を楽しくおはなしします。
</code></pre>
<p class="image-container"><img alt="story02-007" src="img/a22c09d8e6e10189.png"></p>
<p>そして、Home BlockのStartの右端からSpeak Blockの左端までドラッグしながら線でつなげます。</p>
<p class="image-container"><img alt="story02-008" src="img/a9339e64bec0bf82.png"></p>
<p>はい、これが基本的な操作になります。かんたんですよね？おさらいでもう一つSpeak Blockをつなげてみましょう。</p>
<ul>
<li>最初に配置したSpeak Blockの右側にもう一つSpeak Blockを配置します。</li>
<li>Speak Blockの設定画面の入力欄に以下を入力します<pre><code>では今日のお話は、シンデレラ。
</code></pre>
</li>
<li>Speak Block同士を線でつなげます。</li>
</ul>
<p class="image-container"><img alt="story02-009" src="img/f72726f84e1e82dd.png"></p>
<p>２回目なのでもう大丈夫ですよね。ちなみに、線を引き直したい場合は、線の始点側のブロックの四角をクリックするか、線の真ん中にカーソルを合わせると表示されるバケツアイコンをクリックすると消せます。</p>
<p class="image-container"><img alt="story02-009_2" src="img/9741aaf54c28b633.png"></p>
<p>では作ったスキルを実際に動かしてみたいと思います。</p>
<h2 is-upgraded>スキルのアップロードとテスト</h2>
<p>作成したスキルを動かすにはAlexa開発者コンソールへのアップロードが必要です。右上の&#34;Upload to Alexa&#34;というボタンをクリックしてください。</p>
<p class="image-container"><img alt="story02-010" src="img/803ea3ac114b6893.png"></p>
<p>初回に限り、VoiceflowアカウントとAlexa開発者アカウントの紐付けが必要になります。&#34;Connect Amazon&#34;ボタンをクリックしてください。</p>
<p class="image-container"><img alt="story02-011" src="img/cb85e89627022ee.png"></p>
<p>Amazonアカウントのログイン画面が出てきますので、お持ちのAmazonアカウントでログインします。</p>
<p class="image-container"><img alt="story02-012" src="img/f1e24ada0fb22243.png"></p>
<p>VoiceflowからAmazonアカウント経由でAlexaスキル作成等の許可を求める画面が出てきますので、「許可」をクリックします。これでアカウントの紐付けは完了です。</p>
<p class="image-container"><img alt="story02-013" src="img/8cec939eb4dce69c.png"></p>
<p>アップロードが行われます。100%になるまで待ちます。</p>
<p class="image-container"><img alt="story02-014" src="img/469ac975162a1fb6.png"></p>
<p>100％になって&#34;Upload Successful&#34;と表示されればアップロード完了です。ではAlexa開発者コンソールでテストしましょう。&#34;Test on Alexa Simulator&#34;をクリックしてください。</p>
<p class="image-container"><img alt="story02-015" src="img/ee790bd9875b9af7.png"></p>
<p>Alexa開発者コンソールのログイン画面が表示されたら、Amazonアカウントでログインしてください。</p>
<p class="image-container"><img alt="story02-016" src="img/bbbfbd5247ad74b2.png"></p>
<p>Alexa開発者コンソールのテストシミュレータ画面が表示されます。作成したスキルはここでほぼ実機と同じようにテストができます。</p>
<p class="image-container"><img alt="story02-017" src="img/13443b871dd289c8.png"></p>
<p>なお、この時、左上のところで「非公開」が選択されていた場合は「開発中」に変更します。</p>
<p class="image-container"><img alt="story02-019" src="img/5b733189653efb96.png"></p>
<p>テストは文字だけでなく音声でも行なえます。まず最初にマイクを有効にしておきましょう。「許可」をクリックします。</p>
<p class="image-container"><img alt="story02-018" src="img/707dbd0117faacfa.png"></p>
<p>ではいよいよテストです。「日本語」が選択されていることを確認して、マイクアイコンをクリックしたままマイクに「音絵本を開いて」と話しかけて、話し終わったら話してみてください。パソコンにマイクがない場合は、キーボードから入力してENTERキーを押してください。</p>
<p class="image-container"><img alt="story02-020" src="img/d0866908f0ebc9d1.png"></p>
<p>あなたの発話に対して、Voiceflowで設定した内容をAlexaが返してくれればテストは成功です！これでスキル開発の第一歩を踏み出したことになります！おめでとうございます！</p>
<p class="image-container"><img alt="story02-021" src="img/691b0d8f9f7059ac.png"></p>
<p>このように、Voiceflowでスキルを作成 → Alexa開発者コンソールにアップロード → Alexa開発者コンソールでテスト、というのがVoiceflowでのスキル開発の流れになります。</p>
<h2 is-upgraded>効果音やサウンドを使う（その１）</h2>
<p>物語に大事なのは臨場感ですよね！サウンドを効果的に使うことでスキルを楽しいものにすることができます。そしてAlexaやVoiceflowでもサウンドを使ったスキルを作ることができます!ここではサウンドの使い方にトライしてみましょう！</p>
<p>サウンドの使い方は以下の３通りがあります。</p>
<ol type="1">
<li>「Alexa Skills Kitサウンドライブラリ」を使う</li>
<li>mp3ファイルをVoiceflowにアップロードする</li>
<li>mp3ファイルのURLを指定する</li>
</ol>
<p>ここでは、２番めのmp3ファイルアップロードやってみましょう。</p>
<h2 is-upgraded>mp3ファイルをVoiceflowにアップロードする</h2>
<p>自分で作成した効果音や、フリーで配布されているmp3ファイルなどをアップロードして、スキル内で再生することができます。今回はサンプルとして多数の効果音素材を公開されている「効果音ラボ」様のものを使用させてもらいましょう。</p>
<aside class="warning"><p>素材を使用してスキルを作成する場合、素材提供元サイトの規約等を必ず確認の上ご利用いただくようお願いたします。</p>
</aside>
<ul>
<li>以下のURLをクリックしてみてください。<br><a href="https://soundeffect-lab.info/sound/anime/" target="_blank">https://soundeffect-lab.info/sound/anime/</a></li>
<li>上記ページにある「きらきら輝く５」をダウンロードしてください。</li>
</ul>
<p>ではアップロードしましょう。２番めのSpeak Blockの設定を開いて、先程入力した発話の下にある&#34;Audio&#34;をクリックしてください。</p>
<p class="image-container"><img alt="story01-002" src="img/c7c3c3067972edef.png"></p>
<p>オーディオの設定が表示されますので、先ほどダウンロードしてきたmp3ファイルを、図の四角の中にドラッグ＆ドロップします。</p>
<p class="image-container"><img alt="story01-003" src="img/a3090e3af2c1ffbb.png"></p>
<p>以下のように表示されれば正しくアップロードされています。再生ボタンを押すとその場で聞けます。</p>
<p class="image-container"><img alt="story01-004" src="img/d8f780b354ab1b90.png"></p>
<p>はい、ではアップロードして確認してみてください。Alexaが話したあとに効果音が聞こえてくればオッケーです！かんたんですね！</p>
<p>これでシーン０は終了です。次のシーンに行きましょう！</p>
<p>&#34;Next&#34;をクリックしてください</p>


      </google-codelab-step>
    
      <google-codelab-step label="シーン１: 複数のキャラクターの会話" duration="0">
        <p>さぁ、ここからはいよいよ、物語を作っていきましょう。シーン１のイメージはこんな感じです。</p>
<pre><code>むかしむかし、あるところにシンデレラというとても美しくて優しい娘がいました。シンデレラの両親は早くに亡くなってしまったので、今は継母と二人のお姉さんと暮らしていました。ところが、この人たちは大変な意地悪で、

お姉さん１
「シンデレラ、さっさと掃除を終わらせなさいよ。」
お姉さん２
「シンデレラ、掃除が終わったら次は洗濯よ、怠けないでやるのよ。」

シンデレラに家事を全部押しつけた上、

ママ母
「ふん、あんたにはこのボロがお似合いだわ。」

と、粗末な服しか与えてもらえず、シンデレラは毎日つらい日々を送っていました。

そんなある日の事、お城の王子様がお妃選びの舞踏会を開く事になり、シンデレラのお姉さんたちにも招待状が届きました。お姉さんたちは大はしゃぎできれいなドレスに着替えて準備をしています。

ママ母
「そうそう、シンデレラ、あんたも仕事が終われば、舞踏会に来てもいいわ、ただそのボロボロの服でも来れるなら、だけどね。あっはっは。」

そう言い残して、お母さんとお姉さんたちはでかけていきました。

シンデレラ
「ああ、わたしも舞踏会に行きたいわ。でもこんなボロボロの服じゃとても王子さまにお会いできないわ、しくしく」
</code></pre>
<h2 is-upgraded>声を変える</h2>
<p>ではやっていきましょう。</p>
<p>Speak Blockをおいて以下のように入力します。</p>
<pre><code>むかしむかし、あるところにシンデレラというとても美しくて優しい娘がいました。シンデレラの両親は早くに亡くなってしまったので、今は継母と二人のお姉さんと暮らしていました。ところが、この人たちは大変な意地悪で、
</code></pre>
<p class="image-container"><img alt="story01-005" src="img/998c8f52aadd60d3.png"></p>
<p>次はセリフです。Alexaスキルでは、何も設定しなければ&#34;Alexa&#34;という名前の女性の声で喋りますが、この声を変えることができます。早速やってみましょう！</p>
<p>&#34;Speech&#34; をクリックします。</p>
<p class="image-container"><img alt="story01-006" src="img/3cc777686966be73.png"></p>
<p>すると新しい入力欄が下に出てきますので、以下のように入力してください</p>
<pre><code>シンデレラ、さっさと掃除を終わらせなさいよ。
</code></pre>
<p class="image-container"><img alt="story01-007" src="img/648b904b12fce36f.png"></p>
<p>そして、&#34;Speaking as&#34; の右側のリストから &#34;Mizuki&#34; というのを選択してください。</p>
<p class="image-container"><img alt="story01-008" src="img/842fa5b3ab16a2d0.png"></p>
<p>これでアップロードして試してみてください。声が変わっているのがわかりますか？</p>
<p>このように、声を使い分けることでキャラクターごとにセリフを分けることができます。ちなみに、日本語の場合は、</p>
<ul>
<li>Alexa（標準・女性の声）</li>
<li>Mizuki（女性の声）</li>
<li>Takumi（男性の声）</li>
</ul>
<p>から選択することができます。</p>
<aside class="warning"><p>外国人の声を選ぶこともできますが、その場合、日本語を正しく発音してくれるかどうかは保証されません。外国人の声で外国語を話させる場合にはSSMLという言語を使って、どの言語を話すか？をきちんと指定するのが本来のやり方になります。（SSMLについては後ですこし説明しますが、外国語を話すための設定について今回は説明しません）</p>
</aside>
<h2 is-upgraded>声の音程とスピードを変える</h2>
<p>でもちょっとまってください。シンデレラに出てくる登場人物を考えてみましょう。</p>
<ul>
<li>シンデレラ</li>
<li>ママ母</li>
<li>お姉さんその１</li>
<li>お姉さんその２</li>
<li>魔法使いのおばあさん</li>
<li>お城の王子様</li>
<li>ナレーター</li>
</ul>
<p>合計７人もいます。音声の切り替えで対応できるのは３人です。あと４人足りませんね・・・・</p>
<p>そんな場合は、声の音程やスピードを変えることで分けてみましょう。「SSML」という、HTMLに似た言語を使うことで「喋り方」を調節することができます。早速やってみましょう。</p>
<p>先程のセリフ部分を以下に置き換えてください。</p>
<pre><code>&lt;prosody pitch=&#34;x-high&#34; rate=&#34;fast&#34;&gt;シンデレラ、さっさと掃除を終わらせなさいよ。&lt;/prosody&gt;
</code></pre>
<p class="image-container"><img alt="story01-009" src="img/589b298ccc3c8f3a.png"></p>
<p>発話部分を<code>&lt;prosody&gt;</code>と<code>&lt;/prosody&gt;</code>で囲むと、囲んだ部分の発話内容が調節されます。調節する内容は最初の<code>&lt;prosody&gt;</code>内に指定します。<code>pitch</code>で声の高さ、<code>rate</code>で声のスピードを調整できます。</p>
<p>これと最初の音声切り替えを組み合わせることで、複数のキャラクターのセリフを使い分けることができます！今回はこんな感じで各登場人物の声を設定することにします。</p>
<table>
<tr></tr>
<tr><td colspan="1" rowspan="1"><p><strong>登場人物</strong></p>
</td><td colspan="1" rowspan="1"><p><strong>音声</strong></p>
</td><td colspan="1" rowspan="1"><p><strong>音程</strong></p>
</td><td colspan="1" rowspan="1"><p><strong>スピード</strong></p>
</td><td colspan="1" rowspan="1"><p><strong>SSMLタグ</strong></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p><em>ナレーター</em></p>
</td><td colspan="1" rowspan="1"><p>Alexa</p>
</td><td colspan="1" rowspan="1"><p>デフォルト</p>
</td><td colspan="1" rowspan="1"><p>デフォルト</p>
</td><td colspan="1" rowspan="1"><p>-</p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p><em>シンデレラ</em></p>
</td><td colspan="1" rowspan="1"><p>Alexa</p>
</td><td colspan="1" rowspan="1"><p>高い</p>
</td><td colspan="1" rowspan="1"><p>デフォルト</p>
</td><td colspan="1" rowspan="1"><p><code>&lt;prosody pitch=&#34;x-high&#34;&gt;&lt;/prosody&gt;</code></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p><em>ママ母</em></p>
</td><td colspan="1" rowspan="1"><p>Mizuki</p>
</td><td colspan="1" rowspan="1"><p>デフォルト</p>
</td><td colspan="1" rowspan="1"><p>デフォルト</p>
</td><td colspan="1" rowspan="1"><p>-</p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p><em>お姉さん1</em></p>
</td><td colspan="1" rowspan="1"><p>Mizuki</p>
</td><td colspan="1" rowspan="1"><p>高い</p>
</td><td colspan="1" rowspan="1"><p>やや速い</p>
</td><td colspan="1" rowspan="1"><p><code>&lt;prosody pitch=&#34;x-high&#34; rate=&#34;fast&#34;&gt;&lt;/prosody&gt;</code></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p><em>お姉さん2</em></p>
</td><td colspan="1" rowspan="1"><p>Mizuki</p>
</td><td colspan="1" rowspan="1"><p>低い</p>
</td><td colspan="1" rowspan="1"><p>ややゆっくり</p>
</td><td colspan="1" rowspan="1"><p><code>&lt;prosody pitch=&#34;x-low&#34; rate=&#34;slow&#34;&gt;&lt;/prosody&gt;</code></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p><em>魔法使い</em></p>
</td><td colspan="1" rowspan="1"><p>Alexa</p>
</td><td colspan="1" rowspan="1"><p>低い</p>
</td><td colspan="1" rowspan="1"><p>ややゆっくり</p>
</td><td colspan="1" rowspan="1"><p><code>&lt;prosody pitch=&#34;x-high&#34; rate=&#34;slow&#34;&gt;&lt;/prosody&gt;</code></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p><em>王子様</em></p>
</td><td colspan="1" rowspan="1"><p>Takumi</p>
</td><td colspan="1" rowspan="1"><p>デフォルト</p>
</td><td colspan="1" rowspan="1"><p>デフォルト</p>
</td><td colspan="1" rowspan="1"><p>-</p>
</td></tr>
</table>
<p>ではセリフをも含めてこのシーンの設定をしていきましょう。</p>
<p>&#34;Speech&#34;をクリックして新しい入力欄を追加、お姉さん２のセリフなので、音声は&#34;Mizuki&#34;を選択、発話は以下を入力します。</p>
<pre><code>&lt;prosody pitch=&#34;x-low&#34; rate=&#34;slow&#34;&gt;シンデレラ、掃除が終わったら次は洗濯よ、怠けないでやるのよ。&lt;/prosody&gt;
</code></pre>
<p class="image-container"><img alt="story01-011" src="img/908cf5aabb50d61.png"></p>
<p>さらに&#34;Speech&#34;をクリックして、ナレーターなので特に設定せずに、以下を入力。</p>
<pre><code>シンデレラに家事を全部押しつけた上、
</code></pre>
<p class="image-container"><img alt="story01-012" src="img/cf6b968ff07a6678.png"></p>
<p>次はママ母のセリフです。&#34;Speech&#34;を追加して、&#34;Mizuki&#34;を選択して以下を入力します。</p>
<pre><code>ふん、あんたにはこのボロがお似合いだわ。
</code></pre>
<p class="image-container"><img alt="story01-013" src="img/1aeb12f975314b71.png"></p>
<p>最後もナレーターなので、&#34;Speech&#34;を追加して、ナレーターなので特に設定せずに、以下を入力。</p>
<pre><code>と、粗末な服しか与えてもらえず、シンデレラは毎日つらい日々を送っていました。&lt;break time=&#34;1s&#34;/&gt;。
</code></pre>
<p class="image-container"><img alt="story01-014" src="img/9eb6b2e6b2903496.png"></p>
<p>最後に見慣れないSSMLタグが出てきましたが、これもSSMLタグの一つで、発話の中に何も言わない時間を含めるのに使います。このあと少し話が変わるので、場面の切り替わり的に1秒の空白を入れています。</p>
<p>では続きです。ここで話が少し変わるので、もう一つSpeakブロックを追加して、そちらに設定していきましょう。</p>
<pre><code>そんなある日の事、お城の王子様がお妃選びの舞踏会を開く事になり、シンデレラのお姉さんたちにも招待状が届きました。お姉さんたちは大はしゃぎできれいなドレスに着替えて準備をしています。
</code></pre>
<p class="image-container"><img alt="story01-017" src="img/84ceb07420a94a0f.png"></p>
<p>&#34;Speech&#34;で、ママ母のセリフを追加します。</p>
<pre><code>そうそう、シンデレラ、あんたも仕事が終われば、舞踏会に来てもいいわ、ただそのボロボロの服でも来れるなら、だけどね。あっはっは。&lt;/say-as&gt;
</code></pre>
<p class="image-container"><img alt="story01-018" src="img/3108b43dce130a02.png"></p>
<p>もう一つ&#34;Speech&#34;で、以下を入力します。</p>
<pre><code>そう言い残して、お母さんとお姉さんたちはでかけていきました。
</code></pre>
<p class="image-container"><img alt="story01-019" src="img/e6888ef19c87ad4.png"></p>
<p>最後にシンデレラのセリフです。シンデレラの声はAlexaのままですが、声を高くします。あと、このあと別のシーンに切り替わるので、<code>&lt;break time=&#34;1s&#34;/&gt;</code> も追加しておきましょう。</p>
<pre><code>&lt;prosody pitch=&#34;x-high&#34;&gt;ああ、わたしも舞踏会に行きたいわ。でもこんなボロボロの服じゃとても王子さまに、お会いできないわ、しくしく&lt;/prosody&gt;&lt;break time=&#34;1s&#34;/&gt;
</code></pre>
<p class="image-container"><img alt="story01-020" src="img/21cf7726e633a7d6.png"></p>
<p>アップロードしてテストしたいところですが、次のステップをやったあとでテストしましょう。</p>
<h2 is-upgraded>効果音やサウンドを使う（その２）</h2>
<p>効果音やサウンドについては、mp3ファイルをアップする方法を説明しましたが、SSMLでも効果音やサウンドを指定することができます。</p>
<p>そこで活用したいのは「Alexa Skills Kitサウンドライブラリ」です！ Alexaでのスキル開発に活用しやすいように、予めサウンドや効果音が多数公開されています。</p>
<p>以下のURLをクリックしてみてください。<br><a href="https://developer.amazon.com/ja/docs/custom-skills/ask-soundlibrary.html" target="_blank">https://developer.amazon.com/ja/docs/custom-skills/ask-soundlibrary.html</a></p>
<p>少し下に、検索できるような場所があるのがわかるでしょうか？</p>
<p class="image-container"><img alt="story02-047" src="img/c321760f2c41c7c5.png"></p>
<p>ここに「ドア」と入力してENTERキーを押すと検索結果が表示されます。ドアだけでたくさんありますね！どれでもいいのですが、今回は「木（２）」というのを使いますので、これをクリックしてみてください。</p>
<p class="image-container"><img alt="story02-048" src="img/4c478efb3e3a0c04.png"></p>
<p>再生ボタンを押すとサウンドを聞くことができますので、このようにしてお好みのサウンドを探していきます。で、実際にスキルで使うには、この中に表示されているSSMLタグを発話煮含める必要があります。ここの横にある&#34;Copy to clipboard&#34;をクリックして、コピーします。</p>
<p class="image-container"><img alt="story02-049" src="img/35e7b56c4b2a0e6.png"></p>
<p>Voiceflowに戻って、Speak Blockの以下の設定の最後にペースト(WindowsはCtrl+v, Macはcommand+v)してください。これで発話のあとにサウンドが再生されるようになります。</p>
<p class="image-container"><img alt="story01-021" src="img/ec18f7f80b4eddc3.png"></p>
<p>はい、ではいよいよアップロードボタンをクリックしてテストです。キャラクターごとに声やしゃべり方が違って、ドアを閉める音が聞こえれば、シーン1は完成です！</p>
<p>Nextをクリックして次のシーンに行きましょう！</p>
<h2 is-upgraded>おまけ： 発話の中に空白を入れる</h2>
<p>何回か出てきた、<code>&lt;break time=&#34;1s&#34;/&gt;</code>、発話の中に何も言わない時間を含めるのに使います。</p>
<p class="image-container"><img alt="story01-015" src="img/77f8b1ad75663434.png"></p>
<p>というのも、Alexaは句読点（、とか。）があれば、その部分をきちんと意識して読み上げてくれますが、発話中に長めの空白を入れたい場合に「・・・」と入力しても理解してくれません。そこで意図的に空白を入れたい場合は、SSMLのbreakタグを使用します。例えば、</p>
<p>「マヤ・・・なんて恐ろしい子」</p>
<p>と言わせたい場合は以下のようにします。</p>
<pre><code>マヤ&lt;break time=&#34;0.5s&#34;/&gt;なんて恐ろしい子
</code></pre>
<p>どれぐらい空白時間を入れるかは <code>time=&#34;&#34;</code> に秒で設定します。例えば、1秒の場合は &#34;1s&#34; となります。また、prosodyタグと違って、breakタグは閉じるタグが必要がないこと、最後に/がつくのを忘れないように、注意してください。</p>
<p>また、Voiceflowで、Speak Blockをいくつか並べた場合、Blockとしては複数に分かれていたとしても、Alexaが発話するときは一気に話されますので、シーンが変わるような場合にはどこかにbreakタグを入れておくと良いと思います。</p>
<p class="image-container"><img alt="story01-016" src="img/d70fb65d14c801c.png"></p>
<aside class="special"><p>このSpeak Blockをいくつ並べても、Alexaは一気に発話する、というのはとても重要です。あとで説明しますので、ここではそういうものだと覚えておいてください。</p>
</aside>


      </google-codelab-step>
    
      <google-codelab-step label="シーン2: ユーザの発話を受け取りと分岐" duration="0">
        <p>では次のシーンです。シーン２のイメージはこんな感じです。</p>
<pre><code>シンデレラを舞踏会に連れて行ってあげたいですか？連れて行ってあげたい場合は、シンデレラになりきって、舞踏会に行きたいわ、と言ってください。

ユーザ
「舞踏会に行きたいわ」

（効果音: 魔法の音）

シンデレラが強く願うと、その瞬間、突然、魔法使いのおばあさんが目の前に現れ、こういいました。

魔法使いのおばあさん
「泣くのはおよし、シンデレラ。お前はいつも仕事をがんばるとても良い子じゃ、ごほうびにわたしが魔法で舞踏会へ行かせてあげるとしよう。」

シンデレラ
「本当に？」

魔法使いのおばあさん
「本当じゃよ。見ててご覧。」

魔法を使ってシンデレラを変身させるには、ちちんぷいぷい、か、アブラカダブラ、といってください。

（ユーザの発話内容で分岐）

→ユーザ「ちちんぷいぷい」と言った場合、

　魔法使いのおばあさん
　「ちちんぷいぷい、えいっ。」

→ユーザ「アブラカダブラ」と言った場合、

　魔法使いのおばあさん
　「アブラカダブラ、えいっ。」

そういって、魔法使いのおばあさんは魔法の杖を一振りしました。

（効果音：シャラリーン）

すると、畑のかぼちゃが豪華な馬車に、屋根裏のネズミが立派な白馬に、庭のトカゲがパリッとした御者になりました。シンデレラの着ていたみすぼらしい服も、たちまち輝く様な純白の美しいドレスに変わり、そして足元は素敵なガラスのクツになりました。

シンデレラ
「まあ、なんてすてきなの。」

魔法使いのおばあさん
「さあ、楽しんでおいでシンデレラ。でも、わたしの魔法は十二時までしか続かないから、それまでに帰ってくるんじゃよ。」

シンデレラ
「わかったわ、おばあさん、ありがとう、行ってきます。」

（効果音：馬車の音）
</code></pre>
<p>ちょっとボリュームがありますが、がんばっていきましょう！</p>
<h2 is-upgraded>ユーザの発話を受け取る</h2>
<p>このシーンでは、ユーザの発話を受け取って、ストーリーが分岐して進む、というのをやってみましょう！</p>
<p>まず、最初にSpeak Blockで、これからユーザに発話させるのを促す内容を話させます。シーンが変わるので少し離した場所に配置しておくのをおすすめします。</p>
<pre><code>シンデレラを舞踏会に連れて行ってあげたいですか？連れて行ってあげたい場合は、シンデレラになりきって、舞踏会に行きたいわ、と言ってください。
</code></pre>
<p class="image-container"><img alt="story01-022" src="img/4441674b7c2c81c8.png"></p>
<p>次はいよいよユーザの発話の受け取りです。ユーザの発話を受け取るブロックは複数ありますが、もっとも活用の幅が広いInteraction Blockを使いましょう。</p>
<p>Blocksメニューの下の方にAdvancedというサブメニューの中ににある Interaction Block を、2つ目のSpeak Blockの右側にドラッグアンドドロップして、線でつなげてください。</p>
<p class="image-container"><img alt="story01-023" src="img/8780e4f1f6a60c8b.png"></p>
<p>Interaction Blockの設定は３つあり、タブで切り替えて設定します。それぞれのタブで設定する内容は以下となります。</p>
<ul>
<li>Choices<ul>
<li>Intentsで設定したインテントに基づいて、会話の流れを分岐させます。</li>
</ul>
</li>
<li>Intents<ul>
<li>ユーザのしゃべりそうな内容のパターン（「サンプル発話」と言います）をグループ（「インテント」と言います）にまとめることで、分岐の元となるルールを作ります。</li>
</ul>
</li>
<li>Slots<ul>
<li>ユーザのしゃべる内容の中に含まれるキーワード（「スロット」と言います）を変数として、スキルからプログラム的に利用する場合に使用します。</li>
</ul>
</li>
</ul>
<p>といっても、ピンとこないと思うので、実際にやってみましょう。まず最初に&#34;Slots&#34;タブをクリックして、&#34;+ Add slots&#34;</p>
<p>次にIntentsタブをクリックして、&#34;+Add Intent&#34;をクリックします。</p>
<p class="image-container"><img alt="story01-024" src="img/87b1fdd3972a85c6.png"></p>
<p>下に&#34;intent_one&#34;という設定が追加されたと思います。&#34;intent_one&#34;の部分がインテント名になります。</p>
<p class="image-container"><img alt="story01-025" src="img/3ca80520c9b6de22.png"></p>
<p>ちょっとわかりにくいので、まずここで、&#34;intent_one&#34;というのをわかりやすく&#34;butoukai_intent&#34;に変えてください。</p>
<p class="image-container"><img alt="story01-026" src="img/69340f9e36730309.png"></p>
<p>そして、入力欄に「舞踏会に行きたいわ」と入力してENTERキーを押します。入力欄の下に表示されればOKです！</p>
<p class="image-container"><img alt="story01-027" src="img/88015bff2777d4ed.png"></p>
<p>同様にして、以下をすべて入力します。</p>
<pre><code>舞踏会に行きたい
舞踏会行きたい
舞踏会行きたいわ
舞踏会に行きたいな
舞踏会行きたいな
</code></pre>
<p>全部入力し終わってこんな感じになっていればOKです！</p>
<p class="image-container"><img alt="story01-028" src="img/f99d9292c3d5c3a7.png"></p>
<p>では、次にこのインテントを使って分岐をしてみましょう。Choicesタブをクリックして、&#34;Add Choice&#34;をクリックしてください。</p>
<p class="image-container"><img alt="story02-030" src="img/6d2790142a8f86f3.png"></p>
<p>すると下に設定項目のようなものが追加されるとともに、Interaction Blockにも線をつなぐための四角が追加されて、同じ番号になっているのがわかるでしょうか？</p>
<p class="image-container"><img alt="story02-031" src="img/7d2ddb1c1d2bf230.png"></p>
<p>では設定項目の&#34;Select Intent&#34;をクリックしてください。先程作成した&#34;butoukai_intent&#34;が並んでいるのが見えると思うので、これを選択します。</p>
<p class="image-container"><img alt="story02-033" src="img/f7fd28b889a679cb.png"></p>
<p>次にSpeak Blockを２つ、以下のように配置してください。</p>
<p class="image-container"><img alt="story02-034" src="img/acdea8bc50d96ae8.png"></p>
<p>そして、以下のように線を引きます。1と書かれたところからは右のSpeak Blockへ、elseと書かれたところは上のSpeak Blockにつなげて、そこからさらにInteraction Blockに戻します。</p>
<p class="image-container"><img alt="story02-035" src="img/5d4d18fc80b8cf83.png"></p>
<p>それぞれのSpeak Blockは、以下のように設定します。まず、elseにつながった上のSpeak Block。</p>
<pre><code>ごめんなさい。うまく聞き取れませんでした。シンデレラを舞踏会に連れていってあげるには、舞踏会に行きたい、と言ってください。
</code></pre>
<p class="image-container"><img alt="story02-036" src="img/8efa3c29848cd445.png"></p>
<p>次に、1につながった右のSpeak Block。最初にSSMLでサウンドを流していますね。</p>
<pre><code>&lt;audio src=&#34;soundbank://soundlibrary/magic/amzn_sfx_fairy_melodic_chimes_01&#34;/&gt;シンデレラが強く願うと、その瞬間、突然、魔法使いのおばあさんが目の前に現れ、こういいました。
</code></pre>
<p class="image-container"><img alt="story02-037" src="img/7de9e826e804a0ae.png"></p>
<p>2つとも設定ができたら、ここで一度アップロードしてテストしてみましょう。スキルを起動したあと、舞踏会に行きたい、と言うように言われるので、最初に「舞踏会に行きたい」以外のセリフを言って、その後で「舞踏会に行きたい」と言ってください。きちんとそれぞれ分岐していることが確認できるでしょうか？</p>
<p class="image-container"><img alt="story02-038" src="img/d3c566a52a8fe739.png"></p>
<aside class="special"><p>上記のように、テストするときに全部の発話を聞く必要はありません。スキルが起動してすぐに「舞踏会に行きたい」と言うと、途中は飛ばしてその部分からスタートします。</p>
</aside>
<aside class="warning"><p>「舞踏会に行きたい」以外のセリフを言っても、「舞踏会に行きたい」と解釈される場合があります。Alexaはサンプル発話の内容を元にユーザの発話がどのインテントに紐付いているかを推測してくれますが、内容まできっちり正確に認識できるわけではありませんし、そのためには多数のサンプル発話が必要になります。正確に認識するためには多数のサンプル発話を用意する必要があるということを覚えておいてください。</p>
</aside>
<p>もうおわかりになられたかと思いますが、Interaction Blockでユーザの発話をインテントに紐付けて、インテントごとに分岐を分けることで、会話のフローが分岐するという仕組みになっているのです。今回はインテントが一つしかないので、そのインテントか、それ以外かで分かれるようにしています。</p>
<p>このようにして、物語のところどころでユーザの発話に応じて話が展開するインタラクティブなストーリーが作れるというわけですね！是非積極的に使ってなれていきましょう！</p>
<h2 is-upgraded>続き</h2>
<p>では続きです。正しく「舞踏会に行きたい」といった場合のSpeak Blockに追加していきます。ここからはこれまでやったことを続けるだけなので、ペースアップします！</p>
<p>&#34;Speech&#34;を追加して、魔法使いのおばあさんのセリフです。</p>
<pre><code>&lt;prosody pitch=&#34;x-low&#34; rate=&#34;slow&#34;&gt;泣くのはおよし、シンデレラ。お前はいつも仕事をがんばるとても良い子じゃ、ごほうびにわたしが魔法で舞踏会へ行かせてあげるとしよう。&lt;/prosody&gt;
</code></pre>
<p class="image-container"><img alt="story01-029" src="img/7062607fcb0840bf.png"></p>
<p>次はシンデレラのセリフ</p>
<pre><code>&lt;prosody pitch=&#34;x-high&#34;&gt;本当に？&lt;/prosody&gt;
</code></pre>
<p class="image-container"><img alt="story01-030" src="img/13e129488815667b.png"></p>
<p>最後にもう一度、魔法使いのおばあさんのセリフです。</p>
<pre><code>&lt;prosody pitch=&#34;x-low&#34; rate=&#34;slow&#34;&gt;本当じゃよ。見ててご覧。&lt;/prosody&gt;&lt;break time=&#34;1s&#34;/&gt;
</code></pre>
<p class="image-container"><img alt="story01-031" src="img/a2fc0c32fb5b7fb8.png"></p>
<p>ここでもう一つSpeak Blockを追加して、ユーザに発話を促す説明をします。</p>
<pre><code>魔法を使ってシンデレラを変身させるには、ちちんぷいぷい、か、アブラカダブラ、といってください。
</code></pre>
<p class="image-container"><img alt="story01-032" src="img/35e67f2b496e4c2.png"></p>
<p>はい、ここでもユーザの発話を受け取って処理をするので、Interaction Blockを置いて、まずIntentタブをクリックしてインテントを設定しましょう。さっき設定した&#34;butokai_intent&#34;が見えていますが、&#34;+ Add Intent&#34;を２回クリックします。</p>
<p class="image-container"><img alt="story01-033" src="img/536d5b37d22a99a5.png"></p>
<p>新しくインテントが２つ追加されるので、以下のように&#34;chichinpuipui_intent&#34;と&#34;aburakadabura_intent&#34;を作ります。サンプル発話は以下をコピペしてください。</p>
<pre><code>ちちんぷいぷい
ちちんぷいぷいのぷい
</code></pre>
<pre><code>アブラカダブラ
あぶらかだぶら
アブラカタブラ
あぶらかたぶら
</code></pre>
<p class="image-container"><img alt="story01-034" src="img/8e4dc86fcbef52a2.png"></p>
<p>インテントができたら、Choicesタブをクリックして、同じように&#34;+ Add choice&#34;を２回クリック、先程作成した２つのインテントをそれぞれ設定します。</p>
<p class="image-container"><img alt="story01-035" src="img/556901c3c227fbcc.png"></p>
<p>それぞれのフローの先に以下のようにSpeak Blockを配置して線でつなげてください。</p>
<p class="image-container"><img alt="story01-036" src="img/ceb2d0ea28ad117a.png"></p>
<p>それぞれのSpeak Blockの設定内容は以下の通り設定してください。まず、1につながっているSpeak Block。魔法の呪文で「ちちんぷいぷい」といった場合ですね。</p>
<pre><code>&lt;prosody pitch=&#34;x-low&#34; rate=&#34;slow&#34;&gt;ちちんぷいぷい、えいっ。&lt;/prosody&gt;
</code></pre>
<p class="image-container"><img alt="story01-037" src="img/8e404eb9af984638.png"></p>
<p>次に、２につながっているSpeak Block。こちらは「アブラカダブラ」と言った場合です。</p>
<pre><code>&lt;prosody pitch=&#34;x-low&#34; rate=&#34;slow&#34;&gt;アブラカダブラ、えいっ。&lt;/prosody&gt;
</code></pre>
<p class="image-container"><img alt="story01-038" src="img/43ea44d05da0b773.png"></p>
<p>最後に、elseにつながっているSpeak Block。「ちちんぷいぷい」「アブラカダブラ」どちらでもない場合は再度発話をユーザに促します。</p>
<pre><code>魔法の呪文が間違っていますよ。シンデレラを変身させるには、ちちんぷいぷい、か、アブラカダブラ、と言ってください。
</code></pre>
<p class="image-container"><img alt="story01-039" src="img/164f4fb6edf9f965.png"></p>
<p>最後に新しいSpeak Blockを配置して、「ちちんぷいぷい」「アブラカダブラ」で分岐していたフローを一つに戻します。このようにフローを分岐させることも合流させることもできます！</p>
<p class="image-container"><img alt="story01-040" src="img/267cf0a3b0afa687.png"></p>
<p>最後のSpeak Blockの設定内容は以下となります。2つ目以降は、&#34;Speech&#34;を追加して順に設定していってください。</p>
<pre><code>そういって、魔法使いのおばあさんは魔法の杖を一振りしました。&lt;audio src=&#34;soundbank://soundlibrary/magic_spells/magic_spells_07&#34;/&gt;すると、畑のかぼちゃが豪華な馬車に、屋根裏のネズミが立派な白馬に、庭のトカゲがパリッとした御者になりました。シンデレラの着ていたみすぼらしい服も、たちまち輝く様な純白の美しいドレスに変わり、そして足元は素敵なガラスのクツになりました。
</code></pre>
<p class="image-container"><img alt="story01-041" src="img/ad6dbafcde2e14bf.png"></p>
<pre><code>&lt;prosody pitch=&#34;x-high&#34;&gt;まあ、なんてすてきなの。&lt;/prosody&gt;
</code></pre>
<p class="image-container"><img alt="story01-042" src="img/81a73f08408ac120.png"></p>
<pre><code>&lt;prosody pitch=&#34;x-low&#34; rate=&#34;slow&#34;&gt;さあ、楽しんでおいでシンデレラ。でも、わたしの魔法は十二時までしか続かないから、それまでに帰ってくるんじゃよ。&lt;/prosody&gt;
</code></pre>
<p class="image-container"><img alt="story01-043" src="img/89445bf1c878ad96.png"></p>
<pre><code>&lt;prosody pitch=&#34;x-high&#34;&gt;わかったわ、おばあさん、ありがとう、行ってきます。&lt;/prosody&gt;
</code></pre>
<p class="image-container"><img alt="story01-044" src="img/4d8c410f1d47a5d7.png"></p>
<pre><code>シンデレラは舞踏会に向かいました。&lt;audio src=&#34;soundbank://soundlibrary/human/amzn_sfx_people_walking_01&#34;/&gt;&lt;break time=&#34;1s&#34;/&gt;
</code></pre>
<p class="image-container"><img alt="story01-045" src="img/5ce9f31e913bf6c4.png"></p>
<p>はい、これでシーン２は完成です！テストして試してみてください。</p>
<p>では、シーン３にいきましょう！Nextをクリックしてください。</p>


      </google-codelab-step>
    
      <google-codelab-step label="シーン3: 特別なインテント Yes/No と、サウンドを使う場合の注意" duration="0">
        <p>では次のシーンです。シーン3のイメージはこんな感じです。</p>
<pre><code>（効果音：人がしゃべる音）

お城についたシンデレラが、大広間に現れると、そのあまりの美しさに気づいた王子様がシンデレラの前に進み出ました。

王子さま
「美しいお嬢さん、ぼくと、踊っていただけませんか？」

王子様と踊りますか？はい、か、いいえ、で答えてください。

ユーザ
「はい」

シンデレラ
「ええ、よろこんで」

（効果音：ワルツ）

シンデレラと王子様は時間を忘れてダンスを楽しみました。シンデレラはとても幸せでした。

（効果音：鐘の音）

シンデレラ
「あっ、いけない。もうすぐ12時だわ。すぐに帰らないと魔法が溶けちゃう。どうしよう？」
</code></pre>
<p>今までやってきたことでほぼ実現できますね！では順にやっていきましょう。</p>
<p>Speak Blockをおいて、どんどん設定してきます。</p>
<pre><code>&lt;audio src=&#34;soundbank://soundlibrary/voices/crowds/crowds_04&#34;/&gt;お城についたシンデレラが、大広間に現れると、そのあまりの美しさに気づいた王子様がシンデレラの前に進み出ました。
</code></pre>
<p class="image-container"><img alt="story01-046" src="img/f4cb30a2a8b670f5.png"></p>
<p>王子さま、初登場のセリフです。</p>
<pre><code>美しいお嬢さん、ぼくと、踊っていただけませんか？&lt;break time=&#34;1s&#34;/&gt;
</code></pre>
<p class="image-container"><img alt="story01-047" src="img/bb74ee25193a87c7.png"></p>
<p>Speak Blockをもう一つつなげます。</p>
<pre><code>王子様と踊りますか？はい、か、いいえ、で答えてください。
</code></pre>
<p class="image-container"><img alt="story01-048" src="img/f3c2a20b3232088b.png"></p>
<h2 is-upgraded>特別なインテント Yes/No</h2>
<p>ここで、ユーザに踊りますか？と聞いて、発話を受け取るので、ここまでで何度か出てきたInteraction Blockを使います。で、ここまで学んだことを踏まえると、こうなると思いますよね？</p>
<p>はい、と、いいえ、のインテントを作って・・・</p>
<p class="image-container"><img alt="story01-049" src="img/d3d02fb26bd22e94.png"></p>
<p>それぞれのインテントをフローで分ける。</p>
<p class="image-container"><img alt="story01-050" src="img/95736e2c2277fa76.png"></p>
<p>ところが、これ不要なんです！</p>
<p>Alexaにおいて「はい」と「いいえ」は特別な意味を持っていて、予めインテントが用意されています。このように最初から用意されているインテントを「ビルトインインテント」と言い、十分なサンプル発話も登録されているので、スキル開発する側からすると、単にそれを使うだけで良しなにやってくれるという、とても便利で楽ちんなものなんです。</p>
<p>では早速やってみましょう。</p>
<p>Interaction BlockをSpeak Blockにつなげます。で、Choicesタブが選択されているので、そのまま&#34;+ Add Choice&#34;します。</p>
<p class="image-container"><img alt="story01-051" src="img/b165cec5407027f6.png"></p>
<p>リストの中に&#34;NoIntent&#34;があるのが見えますか？これを選択します。</p>
<p class="image-container"><img alt="story01-052" src="img/dd3cbabb898847ff.png"></p>
<p>同様にして&#34;YesIntent&#34;も追加します。</p>
<p class="image-container"><img alt="story01-053" src="img/a7236a9f41a2e659.png"></p>
<p>これだけです。かんたんでしょ？はい、いいえ、を使う場合には、YesIntent/NoIntentを使う、それ以外の複雑な発話の受け取りは自分で作る、と覚えてもらえればよいかと思います。</p>
<aside class="special"><p>YesIntent／NoIntent以外にもビルトインインテントはありますので、興味があれば調べてみてください。<br>標準ビルトインインテント<br><a href="https://developer.amazon.com/ja/docs/custom-skills/standard-built-in-intents.html" target="_blank">https://developer.amazon.com/ja/docs/custom-skills/standard-built-in-intents.html</a></p>
</aside>
<p>では、はい、いいえ、の分岐を作っていきます。Speak Blockを2つおいて、以下のように線を引いてください。YesIntentが右に、Noとelseが上に繋がって、再度Interactionに戻る感じです。</p>
<p class="image-container"><img alt="story01-054" src="img/c534ba59bb5df636.png"></p>
<p>上のSpeak Blockには以下のように設定します。はい、と言わない限り進めない感じ、王室の圧力を感じますねｗ</p>
<pre><code>そんなことを言わないでください。僕はひと目見てあなたの美しさの虜になってしまったのです。
</code></pre>
<pre><code>王子様と踊りますか？はい、か、いいえ、で答えてください。
</code></pre>
<p class="image-container"><img alt="story01-055" src="img/cc7d16a5f57d06fb.png"></p>
<p>はい、と答えた場合の右のSpeak Blockはこんな感じです。</p>
<pre><code>&lt;prosody pitch=&#34;x-high&#34;&gt;ええ、よろこんで。&lt;/prosody&gt;
</code></pre>
<p class="image-container"><img alt="story01-056" src="img/3ae7c6fb3eb8fbb6.png"></p>
<p>ということで、ここからダンスが始まります。ダンスにふさわしいmp3ファイルをアップロードしましょう。<br>今回は、フリーBGM素材サイト「DOVA−SYNDROME」様にアップされている、shimtone様の「ぽかぽかワルツ」を使用させていただきます。</p>
<p><a href="https://dova-s.jp/bgm/play10492.html" target="_blank">https://dova-s.jp/bgm/play10492.html</a></p>
<aside class="warning"><p>素材を使用してスキルを作成する場合、素材提供元サイトの規約等を必ず確認の上ご利用いただくようお願いたします。</p>
</aside>
<p>&#34;Audio&#34;をクリックして、mp3ファイルをアップロードします。</p>
<p class="image-container"><img alt="story01-057" src="img/305c332e194e2dbf.png"></p>
<p>はい、続きを設定して行きます。鐘の音が聞こえてきましたね・・・</p>
<pre><code>シンデレラと王子様は時間を忘れてダンスを楽しみました。シンデレラはとても幸せでした。&lt;break time=&#34;0.7s&#34;/&gt;&lt;audio src=&#34;soundbank://soundlibrary/bell/church/church_bells_02&#34;/&gt;
</code></pre>
<p class="image-container"><img alt="story01-058" src="img/cb77c5c009433378.png"></p>
<pre><code>&lt;prosody pitch=&#34;x-high&#34;&gt;あっ、いけない。もうすぐ12時だわ。すぐに帰らないと魔法が解けちゃう。どうしよう？&lt;/prosody&gt;
</code></pre>
<p class="image-container"><img alt="story01-059" src="img/474fd5beb84b4c4f.png"></p>
<p>はい、これで、シーン３は完成です。いよいよ運命の決断、って感じですね！次はいよいよ最後のシーンです！</p>
<p>その前に、大事なことを一つだけお話しておきます。</p>
<h2 is-upgraded>サウンド・効果音を使う場合の制約</h2>
<p>これまでなんの気なしにサウンドや効果音を使っていますが、とても大事なお約束があります。サウンドや効果音を使う場合、</p>
<ul>
<li>Alexaからの１回の発話で使用できるサウンドや効果音は５回まで。</li>
<li>Alexaからの１回の発話で使用できるサウンドや効果音の合計再生時間は240秒まで。</li>
</ul>
<p>これ、どういうことか見てみましょう。シーン２とシーン３のところを見てください。</p>
<p class="image-container"><img alt="story01-060" src="img/9bd00dd7db763bc3.png"></p>
<p>Alexaの１回の発話というのは、ユーザの発話に囲まれた間のことを指しています。以前に、Speak Blockを分けて並べても、全て一気に話されるというお話をしましたよね？つまり、ユーザの発話と発話の間に入れれるサウンドや効果音の利用回数や合計再生時間には上限があるので、これを超えてたくさんのサウンド・効果音を使いたい場合は、必ずユーザの発話を定期的に入れる必要があるということなんですね。これはSSMLで入れる場合もmp3ファイルでアップロードする場合も変わりません。</p>
<p>先程のシーンの中で音楽ファイルが使われている箇所を見てみましょう。</p>
<p class="image-container"><img alt="story01-061" src="img/c6a25763e15015fc.png"></p>
<p>音楽ファイルが使われている箇所は２回で、どちらも短いものなので、問題ありません。ただ、物語スキルを作ろうとすると、どうしても効果音をたくさん入れたくなると思うので、この点には注意してください。逆にこの制約を逆手にとって、ユーザがただ聞くだけのスキルではなく、インタラクティブに飽きさせないようにするのが重要なポイントだと思います。</p>
<p>ではいよいよ、最後のシーンにいきましょう！</p>
<p>Nextをクリックしてください。</p>


      </google-codelab-step>
    
      <google-codelab-step label="最終シーン：ワークショップ" duration="0">
        <p>ではいよいよ最後のシーンです。最後のシーンは、ワークショップ的に、途中まではこの資料の中で説明しますので、ここまでに説明してきた内容を参考に、皆さんでストーリーを組み立てていただきたいと思います。あと、いきなりは厳しい、という方もいらっしゃるかと思うので、次の章でサンプルをご紹介します。それに沿ってやっていただいても結構です。</p>
<p>ではやっていきましょう。</p>
<p>Speak Blockを置いて設定していきます。シーンが変わるのでちょっと離れたところに置くと良いと思います。</p>
<pre><code>ここで運命の選択です。
</code></pre>
<p class="image-container"><img alt="story01-062" src="img/a9fd97a56990659d.png"></p>
<p>効果音を入れましょう。「効果音ラボ」様の以下のURLから「ショック1」というのをダウンロードしてきてアップロードしてください。<br><a href="https://soundeffect-lab.info/sound/search.php?searchtext=%E3%82%B7%E3%83%A7%E3%83%83%E3%82%AF&x=0&y=0" target="_blank">https://soundeffect-lab.info/sound/search.php?searchtext=%E3%82%B7%E3%83%A7%E3%83%83%E3%82%AF&amp;x=0&amp;y=0</a></p>
<p class="image-container"><img alt="story01-063" src="img/6f0e5ff1e4b41a1e.png"></p>
<p>&#34;Speech&#34;で追加します。</p>
<pre><code>魔法が解ける十二時まで時間はあまりありません。魔法使いのおばあさんとの約束を守るには今すぐ帰る必要があります。&lt;break time=&#34;0.5s&#34;/&gt;でも幸せな舞踏会はまだまだ続きます。もしかすると魔法が解けても王子さまはシンデレラのことを信じてくれるかもしれません。&lt;break time=&#34;0.5s&#34;/&gt;シンデレラは家に帰りますか？はい、か、いいえで答えてください。
</code></pre>
<p class="image-container"><img alt="story01-064" src="img/9f917a0b6c2ddb41.png"></p>
<p>はい、ここでユーザ発話ですね、先程と同じく、Yes/Noの発話なのでInteraction Blockをおいて、Yes/No Intentでフローを作ってください。</p>
<p class="image-container"><img alt="story01-065" src="img/9464aeccea08c501.png"></p>
<p>そして、分岐後のSpeak Blockを以下のように並べて線でつなげます。elseのときはもう一度聞くようにぐるっと回すのも見慣れてきたのではないかなと思います。</p>
<p class="image-container"><img alt="story01-066" src="img/1234b457b38e914b.png"></p>
<p>elseにつながっているSpeak Blockだけ設定を入れておきます。</p>
<pre><code>ごめんなさい。うまく聞き取れませんでした。シンデレラは家に帰りますか？はい、か、いいえで答えてください。
</code></pre>
<p>はい、ではここからは皆様におまかせします。はい、いいえ、それぞれのフローの先にストーリーを作ってみてください！</p>


      </google-codelab-step>
    
      <google-codelab-step label="付録1: ワークショップのサンプル例" duration="0">
        <p>ワークショップ部分の一つのサンプル例をご紹介します。</p>


      </google-codelab-step>
    
      <google-codelab-step label="付録2: 補足" duration="0">
        <h2 is-upgraded>スキルの完成サンプルについて</h2>
<p>３つのサンプルをご紹介します。以下のダウンロードリンクをクリックすると、Voiceflow内にコピーされますので、参考にしてみてください。</p>
<p>なお、繰り返しになりますが、</p>
<aside class="warning"><p>このスキルを審査・公開しないようにお願いします。今後のワークショップで使えなくなってしまいます。</p>
</aside>
<ul>
<li>今回のハンズオンとワークショップ冒頭部分までになっています。ここからストーリーを広げていただければと思います。<br><a href="https://creator.voiceflow.com/dashboard?import=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJwcm9qZWN0SWQiOjgxODUxLCJwcm9qZWN0TmFtZSI6IuS4lueVjOOBruOBiuOBqOOBiOOBu-OCk-OCt-ODp-ODvOODiOODkOODvOOCuOODp-ODsyIsImlhdCI6MTU3NTgxMDg3MH0.dPeH-7auWHulY_7L6EydzCwyYvv1hoMHnsb3zpv0z1U" target="_blank">https://creator.voiceflow.com/dashboard?import=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJwcm9qZWN0SWQiOjgxODUxLCJwcm9qZWN0TmFtZSI6IuS4lueVjOOBruOBiuOBqOOBiOOBu-OCk-OCt-ODp-ODvOODiOODkOODvOOCuOODp-ODsyIsImlhdCI6MTU3NTgxMDg3MH0.dPeH-7auWHulY_7L6EydzCwyYvv1hoMHnsb3zpv0z1U</a></li>
<li>付録１で説明したサンプル例を含めたものです。</li>
<li>ロングバージョンです。シンデレラのオリジナルの話に沿いながら、元木さんが作った台本で脚色しています。<br><a href="https://creator.voiceflow.com/dashboard?import=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJwcm9qZWN0SWQiOjgxMDY4LCJwcm9qZWN0TmFtZSI6IuS4lueVjOOBruOBiuOBqOOBiOOBu-OCkyIsImlhdCI6MTU3NTgwOTU4MH0.76J9SuwCFYX5I6hGxr-MXxAJxAZF9EgLuTIOles5kCo" target="_blank">https://creator.voiceflow.com/dashboard?import=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJwcm9qZWN0SWQiOjgxMDY4LCJwcm9qZWN0TmFtZSI6IuS4lueVjOOBruOBiuOBqOOBiOOBu-OCkyIsImlhdCI6MTU3NTgwOTU4MH0.76J9SuwCFYX5I6hGxr-MXxAJxAZF9EgLuTIOles5kCo</a></li>
</ul>


      </google-codelab-step>
    
  </google-codelab>

  <script src="https://storage.googleapis.com/codelab-elements/native-shim.js"></script>
  <script src="https://storage.googleapis.com/codelab-elements/custom-elements.min.js"></script>
  <script src="https://storage.googleapis.com/codelab-elements/prettify.js"></script>
  <script src="https://storage.googleapis.com/codelab-elements/codelab-elements.js"></script>

</body>
</html>
